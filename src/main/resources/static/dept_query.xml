<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ssafy.hrm.model.dao.DeptDao">

	<select id="findAllDepartments" resultType="dept">
		select * from s_dept;
	</select>
	
	<resultMap type="Emp" id="EmpResultMap"> <!-- type은 VO, id는 고유한 이름 -->
		<id column="eid" property="id"/> <!-- primary key property는 vo꺼-->
		<!-- <id column="eid" property="id"/> 복합키의 경우 걍 id 여러개 주면 됨--> 		
		<result column="ename" property="name"/> <!-- others columns -->
		<result column="did" property="dept_id"/>
	</resultMap>
	
	<resultMap type="dept" id="deptResultMap">
		<id column="dept_id" property="dept_id"/>
		<result column="dname" property="name"/>
		<result column="region_id" property="region_id"/>
		<!-- association : 죽을때까지 가지고 있을 수 있는 멤버변수 has-a -->
		<!-- resultMap의 타입 dept을 기준으로 여러개 있다면 collection -->
		<collection property="employees" resultMap="EmpResultMap">
			
		</collection>
	</resultMap>
	<!--  -->
	<select id="findDeptByIdWithEmployees" parameterType="int" resultMap = "deptResultMap">
		select d.dept_id, d.name as dname, d.region_id, e.id eid, e.name as ename
		from s_dept d 
		left outer join s_emp e
		on(d.dept_id = e.dept_id)
		where d.dept_id = #{id}
	</select>
</mapper>






